<template name="postPage">
    <style>
        input[class="form-control"]{
            float: right;
        }
    </style>
    <form>
        <div class="row">
            <div class="col-md-10">
                <div class="col-md-7">
                    <span>{{#mathjax}}<h2 style="display: inline;">{{>titleTemplate}}</h2>{{/mathjax}}</span>
                </div>
                <div class="col-md-3">
                    <span> <h3 style="display: inline;">Posted by: {{ findUser userID }}</h3></span>
                </div>
            </div>
            <div class="col-md-2">
                {{#if isAdmin}}
                {{#if editMode}}
                <button class="savePostButton btn btn-success" type="button" style="float: right">
                    Save changes <span class="glyphicon glyphicon-pencil"></span>
                </button>
                {{else}}
                <button class="editPostButton btn btn-warning" type="button" style="float: right">
                    Edit Post <span class="glyphicon glyphicon-pencil"></span>
                </button>
                {{/if}}
                {{/if}}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <div class="form-inline form-group">
                    <label for="doi">DOI: </label>
                    {{#if editMode}}
                    <input class="form-control" name="editableInputField" type="text" id="doi" value="{{doi}}" style="text-align: right"/>
                    {{else}}
                    <span class="viewSpan" style="float: right" name="doi">{{doi}}</span>
                    {{/if}}
                </div>
            </div>
            <!-- <div class="col-md-1"></div> -->
            <div class="col-md-4">
                <div class="form-inline form-group">
                    <label for="publish_date">DATE PUBLISHED:</label>
                    {{#if editMode}}
                    <input class="form-control" type="text"  name="editableInputField" id="publish_date" value="{{publish_date}}" style="text-align: right"/>
                    {{else}}
                    <span  class="viewSpan" style='float: right' name='editableInputField'>{{publish_date}}</span>
                    {{/if}}
                </div>
            </div>
            <div class="col-md-3 text-center">
                <label for="">Community Quality Rating:</label>
                {{> starsRating class='center-block' rating=community_quality_rating}}
                <label for="">Rate this paper's Quality: </label>
                {{> starsRating id='user-rating' class='center-block' rating=user_quality_rating mutable=true}}
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="form-inline form-group">
                    <label for="publisher">Publisher: </label>
                    {{#if editMode}}
                    <input class="form-control" type="text" name="editableInputField" id="publisher" value="{{ publisher }}" style="text-align: right"/>
                    {{else}}
                    <span class="viewSpan" name="publisher" style="float: right" value="{{publisher}}">{{publisher}}</span>
                    {{/if}}
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-inline form-group">
                    <label for="author">Author: </label>
                    {{#if editMode}}
                    <input class="form-control" type="text" name="editableInputField" id="author" value="{{author}}" style="text-align: right"/>
                    {{else}}
                    <span class="viewSpan" name="author" style="float: right">{{author}}</span>
                    {{/if}}
                </div>
            </div>
        </div>

        <div class="row">
        </div>

        <div class="row">
            <div class="col-md-4">
                <label>Terms used in this paper: </label>
            </div>
            <div class="col-md-4">
                <label>Terms defined in this paper:</label>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                {{#each terms_used}}
                    <li> {{>nameTemplate}} </li>
                {{/each}}
            </div>
            <div class="col-md-4">
                {{#each terms_defined}}
                    <li> {{>nameTemplate}} </li>
                {{/each}}
            </div>
        </div>

        <div class="row">
            <div class="col-md-1">
                <label>Tags:</label>
            </div>
            <div class="col-md-4">
                {{#each tags}}
                <a href="{{pathFor 'tagPage'}}">{{tag}}</a>
                {{#if loggedIn}}
                <span id="remove_tag" tag="{{tag}}" tag_id="{{_id}}" class="glyphicon glyphicon-remove" style="color:red"></span>
                {{/if}}
                &nbsp;
                {{/each}}
                {{#if loggedIn}}
                <a id="add_tag">new tag...</a>
                {{/if}}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                {{#if add_tag_mode}}
                <input class="form-control" type="text" id="tag_input" value=""/>
                <button class="btn btn-default" id="cancel_tag" type="button">
                Cancel
                </button>
                <button class="btn btn-default" id="submit_tag" type="button" style="float: right">
                Submit Tag
                </button>
                {{/if}}
            </div>
        </div>

        <div class="row">
            <div class="col-md-1">
                <label for="summaries">Summary: </label>
            </div>
            <div class="col-md-3">
                <a class="btn btn-default" style="float: right" name="submitDefinition"
                    href="{{#if loggedIn}}{{pathFor 'submitSummary' data=submitSummaryData}}{{/if}}"
                    disabled="{{#if loggedIn}}{{else}}true{{/if}}">Submit summary</a>
            </div>
            <div class="col-md-4">
                <button class="summary-button btn btn-default" type="button" style="float: right" id="showAllSummaries">
                    {{#if showAllSummaries}}
                    Show top Summary
                    {{else}}
                    Show all Summaries
                    {{/if}}
                </button>
            </div>
        </div>
    </form>
    <br>

    <div class="row">
        <div class="col-md-12">
            {{#if showAllSummaries}}
                {{#each allSummaries}}
                    {{> summaryTemplate}}
                {{/each}}
            {{else}}
                {{#each topSummary}}
                    {{> summaryTemplate}}
                {{/each}}
            {{/if}}
        </div>
    </div>
    <br>

    <div class="row">
        <div class="col-md-6">
            <label>Comments:</label>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6" id="comments">
            {{#each comments}}
            {{> commentItem}}
            {{/each}}
        </div>
    </div>
    <div class="row">
        <!-- {{#if currentUser}} -->
        {{> commentSubmit}}
        <!-- {{else}} -->
        <!-- <p>Please log in to leave a comment</p> -->
        <!-- {{/if}} -->
    </div>
</template>
